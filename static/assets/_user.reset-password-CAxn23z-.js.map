{"version":3,"file":"_user.reset-password-CAxn23z-.js","sources":["../../src/components/reset-password-form.tsx","../../src/routes/_user.reset-password.tsx?tsr-split=component"],"sourcesContent":["import { useNavigate } from '@tanstack/react-router'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\nimport { useMutation } from '@tanstack/react-query'\nimport { CheckCircle2, LoaderCircle, XCircle } from 'lucide-react'\nimport { z } from 'zod'\nimport { toast } from 'sonner'\nimport type { ComponentPropsWithoutRef } from 'react'\nimport type { SubmitHandler } from 'react-hook-form'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Card, CardContent, CardHeader } from '@/components/ui/card'\nimport { cn } from '@/lib/utils'\nimport { confirmPasswordResetMutation } from '@/client/@tanstack/react-query.gen'\nimport { NGS360Logo } from '@/components/ngs360-logo'\n\nconst schema = z\n  .object({\n    password: z\n      .string()\n      .min(8, 'Password must be at least 8 characters')\n      .max(100, 'Password must be at most 100 characters'),\n    confirmPassword: z.string(),\n  })\n  .refine((data) => data.password === data.confirmPassword, {\n    message: \"Passwords don't match\",\n    path: ['confirmPassword'],\n  })\n\ntype FormFields = z.infer<typeof schema>\n\ninterface ResetPasswordFormProps extends ComponentPropsWithoutRef<'form'> {\n  token: string\n}\n\nexport function ResetPasswordForm({\n  token,\n  className,\n  ...props\n}: ResetPasswordFormProps) {\n  const navigate = useNavigate()\n\n  const {\n    register,\n    handleSubmit,\n    setError,\n    formState: { errors, isSubmitting },\n  } = useForm<FormFields>({\n    defaultValues: {\n      password: '',\n      confirmPassword: '',\n    },\n    resolver: zodResolver(schema),\n  })\n\n  const { mutate, isPending, isSuccess, isError, error } = useMutation({\n    ...confirmPasswordResetMutation(),\n    onError: (err) => {\n      const message =\n        err.response?.data.detail?.toString() || \n        'The reset token is invalid or has expired. Please request a new password reset.'\n      setError('root', { message })\n      toast.error(message)\n    },\n    onSuccess: () => {\n      toast.success('Password reset successful! You can now log in with your new password.')\n    },\n  })\n\n  const onSubmit: SubmitHandler<FormFields> = async (data) => {\n    mutate({ \n      body: { \n        token,\n        new_password: data.password,\n      } \n    })\n  }\n\n  // Show success state\n  if (isSuccess) {\n    return (\n      <Card className=\"w-full max-w-md\">\n        <CardHeader></CardHeader>\n        <CardContent className=\"flex flex-col items-center gap-6\">\n          <CheckCircle2 className=\"h-16 w-16 text-green-500\" />\n          <div className=\"text-center space-y-4\">\n            <div>\n              <h3 className=\"text-lg font-semibold mb-2\">Password Reset Successful!</h3>\n              <p className=\"text-muted-foreground\">\n                Your password has been reset. You can now log in with your new password.\n              </p>\n            </div>\n            <Button \n              onClick={() => navigate({ to: '/login' })} \n              className=\"w-full\"\n            >\n              Go to Login\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  // Show error state\n  if (isError) {\n    return (\n      <Card className=\"w-full max-w-md\">\n        <CardHeader></CardHeader>\n        <CardContent className=\"flex flex-col items-center gap-6\">\n          <XCircle className=\"h-16 w-16 text-destructive\" />\n          <div className=\"text-center space-y-4\">\n            <div>\n              <h3 className=\"text-lg font-semibold mb-2\">Reset Failed</h3>\n              <p className=\"text-muted-foreground\">\n                {error.response?.data.detail?.toString() || \n                 'The reset token is invalid or has expired. Please request a new password reset.'}\n              </p>\n            </div>\n            <Button \n              onClick={() => navigate({ to: '/forgot-password' })} \n              className=\"w-full\"\n              variant=\"outline\"\n            >\n              Request New Reset Link\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <Card className=\"w-full max-w-md\">\n      <CardHeader></CardHeader>\n      <CardContent>\n        <form\n          onSubmit={handleSubmit(onSubmit)}\n          className={cn('flex flex-col gap-6', className)}\n          {...props}\n        >\n          {/* Logo and Title Section */}\n          <div className=\"flex flex-col items-center gap-2 text-center\">\n            <NGS360Logo className=\"mb-2\" />\n            <h1 className=\"text-2xl font-bold\">Reset Your Password</h1>\n            <p className=\"text-sm text-muted-foreground max-w-xs\">\n              Enter your new password below.\n            </p>\n          </div>\n\n          {/* Password Input */}\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"password\">New Password</Label>\n            <Input\n              {...register('password')}\n              id=\"password\"\n              type=\"password\"\n              placeholder=\"Enter new password\"\n              required\n            />\n            {errors.password && (\n              <div className=\"text-red-500 text-xs text-left\">\n                {errors.password.message}\n              </div>\n            )}\n          </div>\n\n          {/* Confirm Password Input */}\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"confirmPassword\">Confirm Password</Label>\n            <Input\n              {...register('confirmPassword')}\n              id=\"confirmPassword\"\n              type=\"password\"\n              placeholder=\"Confirm new password\"\n              required\n            />\n            {errors.confirmPassword && (\n              <div className=\"text-red-500 text-xs text-left\">\n                {errors.confirmPassword.message}\n              </div>\n            )}\n          </div>\n\n          {/* Root Error */}\n          {errors.root && (\n            <div className=\"text-red-500 text-sm text-center bg-red-50 dark:bg-red-950/20 p-3 rounded-md\">\n              {errors.root.message}\n            </div>\n          )}\n\n          {/* Submit Button */}\n          <Button\n            disabled={isSubmitting || isPending}\n            type=\"submit\"\n            className=\"flex items-center gap-2\"\n          >\n            {isSubmitting || isPending ? (\n              <>\n                <LoaderCircle className=\"animate-spin\" size={18} />\n                Resetting Password...\n              </>\n            ) : (\n              'Reset Password'\n            )}\n          </Button>\n        </form>\n      </CardContent>\n    </Card>\n  )\n}\n","import { Link, createFileRoute } from '@tanstack/react-router'\nimport { z } from 'zod'\nimport { XCircle } from 'lucide-react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { ResetPasswordForm } from '@/components/reset-password-form'\n\n// Define the search schema for password reset\nconst resetPasswordSearchSchema = z.object({\n  token: z.string().optional(),\n})\n\nexport const Route = createFileRoute('/_user/reset-password')({\n  component: RouteComponent,\n  validateSearch: resetPasswordSearchSchema,\n})\n\nfunction RouteComponent() {\n  const search = Route.useSearch()\n  const { token } = search\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 via-background to-primary-2/5 p-4\">\n      {!token ? (\n        <Card className=\"w-full max-w-md\">\n          <CardHeader>\n            <CardTitle className=\"text-center text-2xl\">Invalid Reset Link</CardTitle>\n          </CardHeader>\n          <CardContent className=\"flex flex-col items-center gap-6\">\n            <XCircle className=\"h-16 w-16 text-destructive\" />\n            <div className=\"text-center space-y-4\">\n              <div>\n                <h3 className=\"text-lg font-semibold mb-2\">No Token Provided</h3>\n                <p className=\"text-muted-foreground\">\n                  No reset token was provided. Please check your email for the password reset link.\n                </p>\n              </div>\n              <Button asChild className=\"w-full\" variant=\"outline\">\n                <Link to=\"/\">Go to Homepage</Link>\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <ResetPasswordForm token={token} />\n      )}\n    </div>\n  )\n}\n"],"names":["schema","z.object","z.string","data","ResetPasswordForm","token","className","props","navigate","useNavigate","register","handleSubmit","setError","errors","isSubmitting","useForm","zodResolver","mutate","isPending","isSuccess","isError","error","useMutation","confirmPasswordResetMutation","err","message","_b","_a","toast","onSubmit","jsxs","Card","jsx","CardHeader","CardContent","CheckCircle2","Button","XCircle","cn","NGS360Logo","Label","Input","Fragment","LoaderCircle","SplitComponent","search","Route","useSearch","CardTitle","Link"],"mappings":"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"}