import{j as e,X as v,r as g,bg as T,u as J,a as U,aj as R,f as F,a5 as K,J as P,a6 as A}from"./index-BIirldc1.js";import{u as B}from"./useQuery-CTa4JkgR.js";import{S as M,a as p}from"./sortable-header-CBUhMdW4.js";import{C as b}from"./copyable-text-hzJJx6rD.js";import{B as y,J as V}from"./job-status-badge-ahLloNQM.js";import{B as x}from"./button-C2PM_K_5.js";import{D as L,a as z,b as G,e as Q,f as N,g as q}from"./index-P1ukJAZU.js";import{C as O}from"./check-DV4XU-UY.js";import{I as W}from"./input-DMyO_KgQ.js";import{P as Z,a as $,b as H}from"./popover-Daw9D_6H.js";import{U as X}from"./user-Db7k31Xy.js";import{R as Y}from"./refresh-cw-6Ar4KVNV.js";import"./useBaseQuery-o_MHl0Bk.js";import"./scroll-area-BlkD1AVU.js";import"./circle-x-D_RBEnZV.js";import"./circle-play-u-Uw65K8.js";import"./zap-BU4rm8MZ.js";function ee({label:m,icon:a,options:l,value:o,onChange:i}){const u=l.find(r=>r.value===o),n=!!o;return e.jsxs(L,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"default",className:"gap-2",children:[e.jsx(a,{className:"h-4 w-4"}),e.jsx("span",{children:m}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-[1px] bg-border"}),e.jsx(y,{variant:"secondary",className:"px-1.5 font-normal",children:(u==null?void 0:u.label)||o})]})]})}),e.jsxs(G,{align:"end",className:"min-w-[200px]",children:[e.jsx(Q,{children:m}),e.jsx(N,{}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-2 py-1.5",children:e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>i(null),className:"w-full justify-start h-8 px-2",children:[e.jsx(v,{className:"mr-2 h-3.5 w-3.5"}),"Clear filter"]})}),e.jsx(N,{})]}),l.map(r=>{const d=o===r.value,c=r.icon;return e.jsxs(q,{checked:d,onCheckedChange:()=>{i(d?null:r.value)},className:"gap-2",children:[c&&e.jsx(c,{className:"h-4 w-4"}),e.jsx("span",{className:"flex-1",children:r.label}),d&&e.jsx(O,{className:"h-4 w-4"})]},r.value)})]})]})}function se({label:m,icon:a,value:l,onChange:o,placeholder:i="Enter text..."}){const[u,n]=g.useState(!1),r=!!l,d=c=>{c.key==="Enter"&&n(!1)};return e.jsxs(Z,{open:u,onOpenChange:n,children:[e.jsx($,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"default",className:"gap-2",children:[e.jsx(a,{className:"h-4 w-4"}),e.jsx("span",{children:m}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-[1px] bg-border"}),e.jsx(y,{variant:"secondary",className:"px-1.5 font-normal",children:l})]})]})}),e.jsx(H,{align:"end",className:"w-80",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:m}),e.jsx(W,{placeholder:i,value:l||"",onChange:c=>o(c.target.value||null),onKeyDown:d,className:"h-9"})]}),r&&e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>o(null),className:"w-full justify-start",children:[e.jsx(v,{className:"mr-2 h-3.5 w-3.5"}),"Clear filter"]})]})})]})}const be=function(){const a=T.useSearch(),l=J(),o=U(),[i,u]=g.useState({pageIndex:a.page-1,pageSize:a.per_page}),[n,r]=g.useState([{id:a.sort_by,desc:a.sort_order==="desc"}]);g.useEffect(()=>{var s,t;l({to:"/admin/jobs",search:{...a,page:i.pageIndex+1,per_page:i.pageSize,sort_by:(s=n[0])==null?void 0:s.id,sort_order:(t=n[0])!=null&&t.desc?"desc":"asc",status_filter:a.status_filter,user_filter:a.user_filter},replace:!0})},[i,n]);const d=s=>{l({to:"/admin/jobs",search:{...a,status_filter:s,page:1}})},c=s=>{l({to:"/admin/jobs",search:{...a,user_filter:s,page:1}})},_=R({query:{skip:(a.page-1)*a.per_page,limit:a.per_page,sort_by:a.sort_by,sort_order:a.sort_order,status_filter:a.status_filter,user:a.user_filter}}),{data:h,error:j,isFetching:f}=B({...F({query:{skip:(a.page-1)*a.per_page,limit:a.per_page,sort_by:a.sort_by,sort_order:a.sort_order,status_filter:a.status_filter,user:a.user_filter}}),placeholderData:A}),C=()=>{o.invalidateQueries({queryKey:_,refetchType:"all"})},S=s=>{l({to:"/jobs/$job_id",params:{job_id:s}})};if(j)return"An error has occurred: "+j.message;if(!h)return e.jsx(K,{variant:"ellipsis"});const w=[{label:"SUBMITTED",value:"SUBMITTED"},{label:"PENDING",value:"PENDING"},{label:"RUNNABLE",value:"RUNNABLE"},{label:"STARTING",value:"STARTING"},{label:"RUNNING",value:"RUNNING"},{label:"SUCCEEDED",value:"SUCCEEDED"},{label:"FAILED",value:"FAILED"}],D=Math.ceil(h.count/a.per_page),I=[{accessorKey:"id",meta:{alias:"Job ID"},header:({column:s})=>e.jsx(p,{column:s,name:"Job ID"}),cell:({cell:s})=>{const t=s.getValue();return e.jsx(b,{text:t,variant:"primary"})}},{accessorKey:"name",meta:{alias:"Job Name"},header:({column:s})=>e.jsx(p,{column:s,name:"Job Name"}),cell:({cell:s})=>{const t=s.getValue();return e.jsx("span",{className:"text-sm",children:t})}},{accessorKey:"user",meta:{alias:"User"},header:({column:s})=>e.jsx(p,{column:s,name:"User"}),cell:({cell:s})=>{const t=s.getValue();return e.jsx("span",{className:"text-sm",children:t})}},{accessorKey:"status",meta:{alias:"Status"},header:({column:s})=>e.jsx(p,{column:s,name:"Status"}),cell:({cell:s})=>{const t=s.getValue();return e.jsx(V,{status:t})}},{accessorKey:"submitted_on",meta:{alias:"Submitted"},header:({column:s})=>e.jsx(p,{column:s,name:"Submitted"}),cell:({cell:s})=>{const t=s.getValue(),k=new Date(t.replace(" ","T")+"Z");return e.jsx("span",{className:"text-sm text-muted-foreground",children:k.toLocaleString(void 0,{timeZoneName:"short"})})}},{accessorKey:"aws_job_id",meta:{alias:"AWS Job ID"},header:"AWS Job ID",cell:({cell:s})=>{const t=s.getValue();return t?e.jsx(b,{text:t,variant:"hoverLight"}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"â€”"})}}],E=e.jsxs(e.Fragment,{children:[e.jsx(ee,{label:"Status",icon:P,options:w,value:a.status_filter||null,onChange:d}),e.jsx(se,{label:"User",icon:X,value:a.user_filter||null,onChange:c,placeholder:"Filter by user..."}),e.jsxs(x,{type:"button",variant:"outline",size:"default",onClick:C,disabled:f,children:[e.jsx(Y,{className:`${f?"animate-spin":""}`}),"Refresh"]})]});return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-3xl",children:"Jobs"}),e.jsx("p",{className:"text-muted-foreground",children:"View and manage system jobs, workflows, and processing tasks."})]})}),e.jsx(M,{data:h.data,columns:I,pagination:i,onPaginationChange:u,pageCount:D,totalItems:h.count,sorting:n,onSortingChange:r,tableTools:E,columnVisibility:{id:!1},rowClickCallback:s=>S(s.original.id)})]})};export{be as component};
//# sourceMappingURL=_auth.admin.jobs.index-DI3GkGN_.js.map
