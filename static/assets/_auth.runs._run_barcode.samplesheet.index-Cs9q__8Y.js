import{as as N,a as v,at as S,au as C,r as m,j as e,a5 as x,u as O,bj as P,bk as Q,h as $,B as b}from"./index-BIirldc1.js";import{u as q}from"./useQuery-CTa4JkgR.js";import{u as k}from"./useMutation-DLDY0_Jn.js";import{t as w}from"./index-CbXsuHis.js";import{h as K,a as M,g as T}from"./sortable-header-CBUhMdW4.js";import{C as d}from"./copyable-text-hzJJx6rD.js";import{F as z,a as B}from"./file-upload-CeWw_3EI.js";import"./useBaseQuery-o_MHl0Bk.js";import"./index-P1ukJAZU.js";import"./scroll-area-BlkD1AVU.js";import"./popover-Daw9D_6H.js";import"./check-DV4XU-UY.js";import"./button-C2PM_K_5.js";import"./input-DMyO_KgQ.js";const y=()=>{const j=N("/_auth/runs/$run_barcode/samplesheet/"),{run_barcode:i}=j.useParams(),n=v(),{mutate:c,isPending:h}=k({...S(),onSuccess:()=>{n.invalidateQueries({queryKey:C({path:{run_barcode:i}})}),w.success(`Samplesheet for run ${i} uploaded successfully`)},onError:o=>{console.error(o)}}),p=m.useCallback(o=>{o.length>0?c({path:{run_barcode:i},body:{file:o[0]}}):console.error("No files accepted")},[]);return h?e.jsx(x,{variant:"ellipsis"}):e.jsx(z,{onDrop:p,displayComponent:e.jsx("span",{className:"text-primary hover:underline mx-2",children:"Drag and drop your samplesheet here, or click to select"})})},ne=function(){var g;const i=N("/_auth/runs/$run_barcode/samplesheet/"),{run_barcode:n}=i.useParams(),c=O(),h=v(),[p,o]=m.useState(""),{data:l,isLoading:_,error:t,isError:u}=q({...P({path:{run_barcode:n}}),retry:!1,throwOnError:!1}),{mutate:f,isPending:D}=k({...S(),onSuccess:()=>{h.invalidateQueries({queryKey:C({path:{run_barcode:n}})}),w.success(`Samplesheet for run ${n} uploaded successfully`)},onError:s=>{console.error(s)}}),E=m.useCallback(s=>{s.length>0?f({path:{run_barcode:n},body:{file:s[0]}}):console.error("No files accepted")},[f,n]);if(m.useEffect(()=>{var s,r;if(u){if(t instanceof Q){const a="An error occurred: "+(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.detail)||t.message||"An unknown error occurred.");alert(a),c({to:"/runs"});return}if(t.status!==404&&t.status!==204){alert("An unknown error occurred."),c({to:"/runs"});return}}},[u,t,c]),_||D)return e.jsx(x,{variant:"ellipsis"});if(u&&(t.status===204||t.status===404))return e.jsx(y,{});if(!l&&!u)return e.jsx(y,{});if(u)return e.jsx(x,{variant:"ellipsis"});const R=Object.entries(l.Header||{}),A=Object.entries(l.Reads||{}),F=Object.entries(l.Settings||{}),H=K(),L=(g=l.DataCols)==null?void 0:g.map(s=>H.accessor(s,{header:({column:r})=>e.jsx(M,{column:r,name:s}),cell:r=>{const a=r.getValue();return a?s==="Sample_Project"?e.jsx(d,{text:a,variant:"hoverLink",asChild:!0,children:e.jsx($,{to:"/projects/$project_id",params:{project_id:a},preload:"intent",children:b(a,p)})}):e.jsx(d,{text:a,variant:"hover",children:b(a,p)}):null}}));return e.jsx("div",{className:"animate-fade-in-up",children:e.jsx(B,{subject:"a new samplesheet",onDrop:E,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:grid md:grid-cols-2 ",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:row-span-2",children:[e.jsx("h2",{className:"text-lg uppercase font-light text-primary",children:"Header"}),e.jsx("table",{children:e.jsx("tbody",{children:R.map(([s,r])=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 align-top",children:s}),e.jsx("td",{className:"p-2 whitespace-normal break-words break-all",children:r&&e.jsx(d,{text:String(r),variant:"hoverLight",className:"items-start [&>button]:p-[0.25em]"})})]},s))})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-lg uppercase font-light text-primary",children:"Reads"}),e.jsx("table",{children:e.jsx("tbody",{children:A.map(([s,r])=>e.jsx("tr",{className:"border-t",children:e.jsx("td",{className:"p-2 align-top",children:String(r)})},s))})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-lg uppercase font-light text-primary",children:"Settings"}),e.jsx("table",{children:e.jsx("tbody",{children:F.map(([s,r])=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 align-top",children:s}),e.jsx("td",{className:"p-2 whitespace-normal break-words break-all",children:r&&e.jsx(d,{text:String(r),variant:"hoverLight",className:"items-start [&>button]:p-[0.25em]"})})]},s))})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-lg uppercase font-light text-primary",children:"Data"}),e.jsx("div",{className:"mb-15",children:e.jsx(T,{data:l.Data??[],columns:L??[],globalFilter:p,onFilterChange:o})})]})]})})})};export{ne as component};
//# sourceMappingURL=_auth.runs._run_barcode.samplesheet.index-Cs9q__8Y.js.map
