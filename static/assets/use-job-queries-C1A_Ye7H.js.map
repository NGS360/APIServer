{"version":3,"file":"use-job-queries-C1A_Ye7H.js","sources":["../../src/hooks/use-job-queries.ts"],"sourcesContent":["/**\n * Shared query options for job-related queries\n */\n\nimport { useMutation, useQueryClient } from '@tanstack/react-query'\nimport { useNavigate } from '@tanstack/react-router'\nimport { \n  getJobQueryKey, \n  getJobsQueryKey, \n  updateJobMutation \n} from '@/client/@tanstack/react-query.gen'\n\n/** Default query options for fetching jobs list */\nexport const DEFAULT_JOBS_QUERY_OPTIONS = {\n  query: {\n    user: 'system',\n    limit: 10,\n    sort_by: 'submitted_on',\n    sort_order: 'desc',\n  },\n} as const;\n\ninterface InvalidateJobQueriesOptions {\n  jobId?: string\n  additionalQueryKeysToInvalidate?: Array<ReadonlyArray<unknown>>\n}\n\n/**\n * Shared helper to invalidate job-related queries.\n * Invalidates all jobs list variants plus optional job/details and additional keys.\n */\nexport function useInvalidateJobQueries() {\n  const queryClient = useQueryClient()\n\n  const invalidateJobQueries = ({\n    jobId,\n    additionalQueryKeysToInvalidate,\n  }: InvalidateJobQueriesOptions = {}) => {\n    queryClient.invalidateQueries({ queryKey: getJobsQueryKey(), refetchType: 'all' })\n\n    if (jobId) {\n      const jobQueryKey = getJobQueryKey({\n        path: { job_id: jobId },\n      })\n      queryClient.invalidateQueries({ queryKey: jobQueryKey, refetchType: 'all' })\n    }\n\n    if (additionalQueryKeysToInvalidate) {\n      for (const queryKey of additionalQueryKeysToInvalidate) {\n        queryClient.invalidateQueries({ queryKey, refetchType: 'all' })\n      }\n    }\n  }\n\n  return {\n    invalidateJobQueries,\n  }\n}\n\n/**\n * Custom hook to handle viewing a job (marking as viewed and navigating)\n * Centralizes the logic for updating job viewed status and invalidating queries\n */\nexport function useViewJob() {\n  const navigate = useNavigate()\n  const { invalidateJobQueries } = useInvalidateJobQueries()\n\n  const updateJobMutationInstance = useMutation({\n    ...updateJobMutation(),\n  })\n\n  /**\n   * Mark a job as viewed and navigate to its details page\n   * @param jobId - The ID of the job to view\n   * @param additionalQueryKeysToInvalidate - Optional additional query keys to invalidate\n   */\n  const viewJob = async (jobId: string, additionalQueryKeysToInvalidate?: Array<ReadonlyArray<unknown>>) => {\n    // Update job status to viewed\n    await updateJobMutationInstance.mutateAsync({\n      path: { job_id: jobId },\n      body: { viewed: true },\n    })\n\n    invalidateJobQueries({\n      jobId,\n      additionalQueryKeysToInvalidate,\n    })\n\n    // Navigate to job details\n    navigate({ to: '/jobs/$job_id', params: { job_id: jobId } })\n  }\n\n  return {\n    viewJob,\n    isUpdating: updateJobMutationInstance.isPending,\n  }\n}\n\n"],"names":["DEFAULT_JOBS_QUERY_OPTIONS","useInvalidateJobQueries","queryClient","useQueryClient","jobId","additionalQueryKeysToInvalidate","getJobsQueryKey","jobQueryKey","getJobQueryKey","queryKey","useViewJob","navigate","useNavigate","invalidateJobQueries","updateJobMutationInstance","useMutation","updateJobMutation"],"mappings":"gHAaO,MAAMA,EAA6B,CACxC,MAAO,CACL,KAAM,SACN,MAAO,GACP,QAAS,eACT,WAAY,MAAA,CAEhB,EAWO,SAASC,GAA0B,CACxC,MAAMC,EAAcC,EAAe,EAsB5B,MAAA,CACL,qBArB2B,CAAC,CAC5B,MAAAC,EACA,gCAAAC,CACF,EAAiC,KAAO,CAGtC,GAFAH,EAAY,kBAAkB,CAAE,SAAUI,IAAmB,YAAa,MAAO,EAE7EF,EAAO,CACT,MAAMG,EAAcC,EAAe,CACjC,KAAM,CAAE,OAAQJ,CAAM,CAAA,CACvB,EACDF,EAAY,kBAAkB,CAAE,SAAUK,EAAa,YAAa,MAAO,CAAA,CAG7E,GAAIF,EACF,UAAWI,KAAYJ,EACrBH,EAAY,kBAAkB,CAAE,SAAAO,EAAU,YAAa,MAAO,CAGpE,CAIA,CACF,CAMO,SAASC,GAAa,CAC3B,MAAMC,EAAWC,EAAY,EACvB,CAAE,qBAAAC,CAAqB,EAAIZ,EAAwB,EAEnDa,EAA4BC,EAAY,CAC5C,GAAGC,EAAkB,CAAA,CACtB,EAuBM,MAAA,CACL,QAjBc,MAAOZ,EAAeC,IAAoE,CAExG,MAAMS,EAA0B,YAAY,CAC1C,KAAM,CAAE,OAAQV,CAAM,EACtB,KAAM,CAAE,OAAQ,EAAK,CAAA,CACtB,EAEoBS,EAAA,CACnB,MAAAT,EACA,gCAAAC,CAAA,CACD,EAGQM,EAAA,CAAE,GAAI,gBAAiB,OAAQ,CAAE,OAAQP,CAAA,EAAS,CAC7D,EAIE,WAAYU,EAA0B,SACxC,CACF"}