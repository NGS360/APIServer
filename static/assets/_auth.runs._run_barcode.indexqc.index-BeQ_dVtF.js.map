{"version":3,"file":"_auth.runs._run_barcode.indexqc.index-BeQ_dVtF.js","sources":["../../node_modules/lucide-react/dist/esm/icons/database-zap.js","../../src/components/indexqc-not-found-component.tsx","../../src/routes/_auth.runs.$run_barcode.indexqc.index.tsx?tsr-split=notFoundComponent"],"sourcesContent":["/**\n * @license lucide-react v0.476.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"ellipse\", { cx: \"12\", cy: \"5\", rx: \"9\", ry: \"3\", key: \"msslwz\" }],\n  [\"path\", { d: \"M3 5V19A9 3 0 0 0 15 21.84\", key: \"14ibmq\" }],\n  [\"path\", { d: \"M21 5V8\", key: \"1marbg\" }],\n  [\"path\", { d: \"M21 12L18 17H22L19 22\", key: \"zafso\" }],\n  [\"path\", { d: \"M3 12A9 3 0 0 0 14.59 14.87\", key: \"1y4wr8\" }]\n];\nconst DatabaseZap = createLucideIcon(\"DatabaseZap\", __iconNode);\n\nexport { __iconNode, DatabaseZap as default };\n//# sourceMappingURL=database-zap.js.map\n","import { DatabaseZap } from \"lucide-react\"\n\n// Define error component for indexqc path\nexport const NotFoundComponent = () => {\n  return (\n    <>\n      <div className=\"flex flex-col gap-4 items-center justify-center mt-25\">\n        <div className=\"relative\">\n          <DatabaseZap className=\"size-32 text-muted-foreground opacity-20\" strokeWidth={1} />\n        </div>\n        <h1 className=\"text-2xl font-light text-muted-foreground\">\n          No IndexQC Data Available\n        </h1>\n      </div>\n    </>\n  )\n}","import { createFileRoute, getRouteApi, notFound, redirect } from '@tanstack/react-router'\nimport { useState } from 'react';\nimport { AxiosError } from 'axios';\nimport type {ColumnDef, Row} from '@tanstack/react-table';\nimport type {BarChartData} from '@/components/indexqc-barchart';\nimport { CopyableText } from '@/components/copyable-text'\nimport { SortableHeader } from '@/components/data-table/sortable-header'\nimport { ClientDataTable } from '@/components/data-table/data-table';\nimport { useIsMobile } from '@/hooks/use-mobile';\nimport {  IndexQCBarChart } from '@/components/indexqc-barchart';\nimport { NotFoundComponent } from '@/components/indexqc-not-found-component';\nimport { getRunMetrics } from '@/client';\nimport { FullscreenSpinner } from '@/components/spinner';\n\nexport const Route = createFileRoute('/_auth/runs/$run_barcode/indexqc/')({\n  component: RouteComponent,\n  loader: async ({ params }) => {\n\n    // Get run metrics data\n    const res = await getRunMetrics({\n      path: {\n        run_barcode: params.run_barcode\n      }\n    });\n\n    if (!res.data) {\n      if (res.status === 204) throw notFound();\n      if (res instanceof AxiosError) {\n        const msg = \"An error occurred: \" + res.error.detail || \"An unknown error occurred.\"\n        alert(msg)\n        throw redirect({ to: '/runs' })\n      }\n      alert('An unknown error occurred.')\n      throw redirect({ to: '/runs'})\n    }\n\n    return ({\n      runMetrics: res.data\n    })\n  },\n  notFoundComponent: NotFoundComponent,\n  pendingComponent: () => <FullscreenSpinner variant='ellipsis' />,\n  pendingMs: 200\n})\n\n// Define data shape for the Read count table\ninterface ReadCountData {\n  Lane: number,\n  \"Total Reads\": number,\n  \"PF Reads\": number\n}\n\nfunction RouteComponent() {\n  // Load run data\n  const routeApi = getRouteApi('/_auth/runs/$run_barcode/indexqc/')\n  const { runMetrics } = routeApi.useLoaderData()\n\n  // Get mobile state\n  const isMobile = useIsMobile();\n\n  // Map data for the table and barchart\n  const readCountData: Array<ReadCountData> = []\n  const barChartData: Array<BarChartData> = []\n  runMetrics.ConversionResults?.forEach((d) => {\n\n    // Compute the total number of reads per lane\n    readCountData.push({\n      Lane: d.LaneNumber,\n      \"Total Reads\": d.TotalClustersRaw * 2,\n      \"PF Reads\": d.TotalClustersPF * 2\n    })\n\n    // Compute the barchart data\n    d.DemuxResults?.forEach(res => {\n      const pct = ((res.NumberReads || 0) / d.TotalClustersPF) * 100\n      barChartData.push({\n        lane: d.LaneNumber,\n        sampleId: res.SampleId,\n        pctReadsIdentified: pct.toFixed(3)\n      })\n    })\n  })\n\n  // Set state for filtering data and setting plot height\n  const [lane, setLane] = useState<number>();\n  const [filteredBarChartData, setFilteredBarChartData] = useState<Array<BarChartData>>()\n\n  // Handle row click callback\n  const handleRowClick = (row: Row<ReadCountData>) => {\n    // Set lane\n    const rowLane = Number(row.getValue('Lane'))\n    setLane(rowLane)\n\n    // Filter barChartData by selected lane\n    const filteredData = barChartData.filter(value => value.lane == rowLane)\n    setFilteredBarChartData(filteredData)\n  }\n\n  // Define columns for metrics table \n  const columns: Array<ColumnDef<ReadCountData>> = [\n    {\n      accessorKey: 'Lane',\n      header: ({ column }) => <SortableHeader column={column} name=\"Lane\" />,\n      cell: ({ cell }) => {\n        const value = cell.getValue() as string\n        return (\n          <CopyableText\n            text={value}\n            variant='hover'\n          />\n        )\n      }\n    },\n    {\n      accessorKey: \"Total Reads\",\n      header: ({ column }) => <SortableHeader column={column} name=\"Total Reads\" />,\n      cell: ({ cell }) => {\n        const value = cell.getValue() as string\n        return (\n          <CopyableText\n            text={value.toLocaleString()}\n            variant='hover'\n          />\n        )\n      }\n    },\n    {\n      accessorKey: \"PF Reads\",\n      header: ({ column }) => <SortableHeader column={column} name=\"PF Reads\" />,\n      cell: ({ cell }) => {\n        const value = cell.getValue() as string\n        return (\n          <CopyableText\n            text={value.toLocaleString()}\n            variant='hover'\n          />\n        )\n      }\n    }\n  ]\n\n  return (\n    <div className='animate-fade-in-up'>\n      <ClientDataTable \n        data={readCountData}\n        columns={columns}\n        rowClickCallback={handleRowClick}\n      />\n      {filteredBarChartData && (\n        <IndexQCBarChart\n          barChartData={filteredBarChartData}\n          title={`Lane ${lane}`}\n          isMobile={isMobile}\n        />\n      )}\n    </div>\n  )\n}\n"],"names":["__iconNode","DatabaseZap","createLucideIcon","NotFoundComponent","jsx","Fragment","jsxs","SplitNotFoundComponent"],"mappings":"+CAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,EAAa,CACjB,CAAC,UAAW,CAAE,GAAI,KAAM,GAAI,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EAClE,CAAC,OAAQ,CAAE,EAAG,6BAA8B,IAAK,QAAQ,CAAE,EAC3D,CAAC,OAAQ,CAAE,EAAG,UAAW,IAAK,QAAQ,CAAE,EACxC,CAAC,OAAQ,CAAE,EAAG,wBAAyB,IAAK,OAAO,CAAE,EACrD,CAAC,OAAQ,CAAE,EAAG,8BAA+B,IAAK,QAAU,CAAA,CAC9D,EACMC,EAAcC,EAAiB,cAAeF,CAAU,ECbjDG,EAAoB,IAG3BC,EAAA,IAAAC,WAAA,CAAA,SAAAC,EAAAA,KAAC,MAAI,CAAA,UAAU,wDACb,SAAA,CAACF,EAAAA,IAAA,MAAA,CAAI,UAAU,WACb,SAAAA,EAAA,IAACH,GAAY,UAAU,2CAA2C,YAAa,CAAA,CAAG,CACpF,CAAA,EACCG,EAAA,IAAA,KAAA,CAAG,UAAU,4CAA4C,SAE1D,2BAAA,CAAA,CAAA,CAAA,CACF,CACF,CAAA,ECoCHG,EAxCQJ","x_google_ignoreList":[0]}