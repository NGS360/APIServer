import{c as _,u as I,r as i,A as E,j as e,B as m,h as y}from"./index-BIirldc1.js";import{u as q}from"./useQuery-CTa4JkgR.js";import{u as A}from"./index.esm-DeL_VMPh.js";import{P as z,c as V,b as $}from"./popover-Daw9D_6H.js";import{S as B,a as F}from"./scroll-area-BlkD1AVU.js";import{B as M}from"./button-C2PM_K_5.js";import{u as P}from"./use-debounce-R5sUNkyS.js";import{S as L}from"./separator-ClsyK3GL.js";import{S as R}from"./search-SEwO8_4z.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],O=_("Delete",H);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],b=_("ExternalLink",K),x=({children:o,onClick:a,isHighlighted:d})=>e.jsx("div",{onClick:a,className:`px-2 py-0.5 rounded-md text-sm cursor-pointer ${d?"bg-muted":"hover:bg-muted"}`,children:o}),N=({children:o,heading:a})=>e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"flex justify-center",children:e.jsx("h1",{className:"px-2 py-1.5 text-xs text-muted-foreground",children:a})}),o]}),Z=({onResultClick:o})=>{const a=I(),[d,j]=i.useState(!1),[n,p]=i.useState(-1),h=i.useRef(null),{register:k,watch:w,setValue:g}=A(),S=w("search",""),r=P(S,300),f=s=>{s(),g("search",""),j(!1),o==null||o()},{data:{projects:c,runs:l}={projects:[],runs:[]}}=q({...E({query:{query:r,n_results:5}}),select:s=>({projects:s.projects.data,runs:s.runs.data}),enabled:!!r});i.useEffect(()=>{j(!!r),p(-1)},[r]);const u=[...c.map(s=>({type:"project",data:s,navigate:()=>a({to:"/projects/$project_id",params:{project_id:s.project_id}})})),...l.map(s=>({type:"run",data:s,navigate:()=>a({to:"/runs/$run_barcode",params:{run_barcode:s.barcode||""}})}))],D=s=>{if(!(!d||u.length===0))switch(s.key){case"ArrowDown":s.preventDefault(),p(t=>t<u.length-1?t+1:t);break;case"ArrowUp":s.preventDefault(),p(t=>t>0?t-1:-1);break;case"Enter":s.preventDefault(),n>=0&&n<u.length&&f(u[n].navigate);break;case"Escape":j(!1),p(-1);break}};return i.useEffect(()=>{h.current&&h.current.scrollIntoView({block:"nearest",behavior:"smooth"})},[n]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 items-center pl-3 rounded-md h-9 border-1",children:[e.jsx(R,{size:16,className:"text-muted-foreground"}),e.jsx("input",{id:"es-input",className:"w-full text-sm focus:outline-none",placeholder:"Search for projects or runs...",...k("search"),onKeyDown:D}),e.jsx(M,{variant:"link",className:"text-muted-foreground hover:text-foreground",onClick:()=>g("search",""),title:"Reset search",children:e.jsx(O,{})})]}),e.jsxs(z,{open:d,children:[e.jsx(V,{}),e.jsx($,{onOpenAutoFocus:s=>s.preventDefault(),className:"w-[var(--radix-popper-anchor-width)] p-1",children:e.jsx(B,{children:e.jsxs("div",{className:"max-h-125",children:[e.jsx(F,{orientation:"vertical"}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{heading:"Projects",children:[c.map((s,t)=>e.jsx(x,{onClick:()=>f(()=>a({to:"/projects/$project_id",params:{project_id:s.project_id}})),isHighlighted:n===t,children:e.jsxs("div",{ref:n===t?h:null,children:[e.jsx("span",{className:"text-sm",children:m(s.project_id,r)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[" ",m(s.name||"",r)]})]})},s.project_id)),e.jsx(x,{children:e.jsxs(y,{className:"flex items-center gap-2 text-primary cursor-pointer",to:"/projects",search:{query:r,sort_by:"name",sort_order:"asc"},children:[e.jsx(b,{size:14}),e.jsx("span",{children:"View all projects"})]})})]}),l.length>0&&e.jsx(L,{className:"my-0.5"})]}),l.length>0&&e.jsxs(N,{heading:"Runs",children:[l.map((s,t)=>{const v=c.length+t;return e.jsx(x,{onClick:()=>f(()=>a({to:"/runs/$run_barcode",params:{run_barcode:s.barcode||""}})),isHighlighted:n===v,children:e.jsxs("div",{ref:n===v?h:null,children:[e.jsx("span",{className:"text-sm",children:m(s.barcode||"",r)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[" ",m(s.experiment_name||"",r)]})]})},s.barcode)}),e.jsx(x,{children:e.jsxs(y,{className:"flex items-center gap-2 text-primary cursor-pointer",to:"/runs",search:{query:r},children:[e.jsx(b,{size:14}),e.jsx("span",{children:"View all runs"})]})})]}),c.length===0&&l.length===0&&e.jsx("div",{className:"flex justify-center p-4 text-sm text-muted-foreground",children:"No results found."})]})})})]})]})};export{Z as S};
//# sourceMappingURL=search-bar-C4mhsUwd.js.map
